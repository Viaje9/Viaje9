(function(t){function e(e){for(var n,i,o=e[0],c=e[1],u=e[2],d=0,m=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&m.push(s[i][0]),s[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);l&&l(e);while(m.length)m.shift()();return r.push.apply(r,u||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],n=!0,o=1;o<a.length;o++){var c=a[o];0!==s[c]&&(n=!1)}n&&(r.splice(e--,1),t=i(i.s=a[0]))}return t}var n={},s={app:0},r=[];function i(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=n,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(a,n,function(e){return t[e]}.bind(null,n));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/HaTalk/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"13dd":function(t,e,a){"use strict";a("f60d")},"440b":function(t,e,a){"use strict";a("b129")},"4a71":function(t,e,a){"use strict";a("a88b")},"4cef":function(t,e,a){},5558:function(t,e,a){"use strict";a("4cef")},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),s=a("2106"),r=a.n(s),i=a("5132"),o=a.n(i),c=a("bc3a"),u=a.n(c),l=u.a.create({baseURL:"https://ha-talk-api.herokuapp.com/",timeout:1e4,withCredentials:!0}),d=l,m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},p=[],v=(a("5c0b"),a("2877")),h={},f=Object(v["a"])(h,m,p,!1,null,null,null),g=f.exports,w=(a("45fc"),a("96cf"),a("1da1")),b=a("8c4f"),C=(a("7db0"),a("b0c0"),a("2f62"));n["a"].use(C["a"]);var _=new C["a"].Store({state:{name:null,account:null,friends:[],auth:!1},mutations:{setUser:function(t,e){var a=e.name,n=e.account,s=e.friends;t.name=a,t.account=n,t.friends=s},updateUserName:function(t,e){t.name=e}},actions:{getUser:function(t){return Object(w["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.state,e.next=3,d.get("/GetUser").then((function(t){var e=t.data,n=e.name,s=e.account,r=e.friends,i=e.success;i&&(a.name=n,a.account=s,a.friends=r,a.auth=!0)}));case 3:case"end":return e.stop()}}),e)})))()}},getters:{getFriendName:function(t){return function(e){var a=t.friends.find((function(t){return t.account===e}));return a?a.name:""}},userData:function(t){return!!t.account}},modules:{}}),x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"outer"},[a("menu-component"),a("div",{staticClass:"container"},t._l(t.firends,(function(e){return a("router-link",{key:e.account,staticClass:"content",attrs:{to:"/Chat/"+e.account}},[a("div",{staticClass:"user"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:t.avatarImg,alt:""}})]),a("div",{staticClass:"name"},[t._v(t._s(e.name))])])])})),1)],1)},k=[],y=a("a692"),P=a.n(y),E={data:function(){return{avatarImg:P.a}},computed:{firends:function(){return this.$store.state.friends}},created:function(){this.$store.dispatch("getUser")}},$=E,O=(a("5558"),Object(v["a"])($,x,k,!1,null,"ccffd752",null)),j=O.exports,N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"outer"},[a("menu-component"),a("div",{staticClass:"container"},[a("div",{staticClass:"content"},[a("div",{staticClass:"room"},[t._v(t._s(t.friend))]),a("div",{attrs:{id:"text_area"}},t._l(t.message,(function(e){return a("div",{key:e.time,staticClass:"msg",class:{user:t.account===e.user}},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:t.avatarImg,alt:""}})]),a("div",{staticClass:"text"},[t._v(t._s(e.text))])])})),0),a("form",{staticClass:"input",on:{submit:function(e){return e.preventDefault(),t.send(e)}}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.msg,expression:"msg"}],attrs:{type:"text",placeholder:"輸入訊息"},domProps:{value:t.msg},on:{input:function(e){e.target.composing||(t.msg=e.target.value)}}}),a("button",{staticClass:"btn",on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit(e)}}},[t._v("送出")])])])])],1)},F=[],R={data:function(){return{message:[],msg:null,friend:null,avatarImg:P.a}},computed:{account:function(){return this.$store.state.account}},mounted:function(){var t=this,e=this,a=this.$store.getters.getFriendName,n=this.$route.params.id,s=this.axios;e.friend=a(n),this.$socket.emit("bind room",n),this.sockets.subscribe("chat message",(function(e){t.message.push(e)})),s.get("/getMsg",{params:{account:n}}).then((function(t){e.message=t.data}))},methods:{send:function(){this.msg&&(this.$socket.emit("chat message",this.msg),this.msg=null)}},updated:function(){var t=document.getElementById("text_area");t.scrollTop=t.scrollHeight-t.offsetHeight}},A=R,U=(a("13dd"),Object(v["a"])(A,N,F,!1,null,"211a67dc",null)),I=U.exports,q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"outer"},[a("div",{staticClass:"container"},[a("div",{staticClass:"left"},[a("form",{staticClass:"login",on:{submit:function(e){return e.preventDefault(),t.login(e)}}},[t._m(0),a("div",{staticClass:"row",class:{loginErr:t.loginErr}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.account,expression:"account"}],attrs:{type:"text",placeholder:"輸入帳號"},domProps:{value:t.account},on:{input:function(e){e.target.composing||(t.account=e.target.value)}}})]),a("div",{staticClass:"row",class:{loginErr:t.loginErr}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"輸入密碼"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),a("div",{staticClass:"row"},[a("router-link",{staticClass:"btn",attrs:{to:"/register"}},[t._v(" 註冊 ")]),a("button",{staticClass:"btn",on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit(e)}}},[t._v("登入")])],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.loginErr,expression:"loginErr"}],staticClass:"err"},[t._v("登入失敗請輸入正確帳號密碼")])]),t._m(1)])])},T=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},[a("h2",[t._v("Login")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"right"},[a("h1",[t._v("HaTalk")]),a("span",[t._v("Copyright © 2020 Viaje9 Design.")])])}],S={data:function(){return{account:null,password:null,loginErr:!1}},methods:{login:function(){var t=this,e=this.axios,a=this.$store,n=this.$router,s=this.account,r=this.password;e.post("/Login",{account:s,password:r}).then(function(){var e=Object(w["a"])(regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!s.data.success){e.next=6;break}return e.next=3,a.dispatch("getUser");case 3:n.push("/").catch((function(t){return console.warn(t)})),e.next=7;break;case 6:t.loginErr=!0;case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}},D=S,H=(a("c67d"),Object(v["a"])(D,q,T,!1,null,"6cbbc062",null)),M=H.exports,L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"outer"},[a("div",{staticClass:"container"},[a("div",{staticClass:"left"},[a("form",{on:{submit:function(e){return e.preventDefault(),t.checkForm(e)}}},[t._m(0),a("div",{staticClass:"row",class:{registerErr:t.errorRegister}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{id:"name",name:"name",type:"text",minlength:"1",maxlength:"10",required:"",placeholder:"輸入暱稱"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),a("div",{staticClass:"row",class:{registerErr:t.errorAccount||t.errorRegister}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.account,expression:"account"}],attrs:{id:"account",name:"account",type:"text",minlength:"4",maxlength:"20",required:"",placeholder:"輸入帳號"},domProps:{value:t.account},on:{change:t.checkAccount,input:function(e){e.target.composing||(t.account=e.target.value)}}})]),a("div",{staticClass:"row",class:{registerErr:t.errorPassword||t.errorRegister}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{id:"password",name:"password",type:"password",minlength:"8",maxlength:"20",required:"",placeholder:"輸入密碼"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),a("div",{staticClass:"row",class:{registerErr:t.errorPassword||t.errorRegister}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.checkPassword,expression:"checkPassword"}],attrs:{id:"checkPassword",name:"checkPassword",type:"password",required:"",placeholder:"確認密碼"},domProps:{value:t.checkPassword},on:{input:function(e){e.target.composing||(t.checkPassword=e.target.value)}}})]),a("div",{staticClass:"row"},[a("router-link",{staticClass:"btn",attrs:{to:"/login"}},[t._v("取消")]),a("button",{staticClass:"btn",attrs:{type:"submit"}},[t._v("註冊")])],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.errorAccount||t.errorPassword||t.errorRegister,expression:"errorAccount || errorPassword || errorRegister"}],staticClass:"err"},[t._v(" "+t._s(t.errorAccount||t.errorPassword||t.errorRegister)+" ")])]),t._m(1)])])},V=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},[a("h2",[t._v("Registered")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"right"},[a("h1",[t._v("HaTalk")]),a("span",[t._v("Copyright © 2020 Viaje9 Design.")])])}],J={data:function(){return{name:null,account:null,password:null,checkPassword:null,errorAccount:null,errorPassword:null,errorRegister:null}},methods:{checkAccount:function(){var t=this;this.axios.get("/CheckAccount",{params:{account:this.account}}).then((function(e){t.errorAccount=e.data?null:"帳號重複請重新輸入"}))},checkForm:function(){var t=this;this.password===this.checkPassword&&null===this.errorAccount?this.axios.post("/Register",{name:this.name,account:this.account,password:this.password}).then((function(e){e.data.success?t.$store.commit("setUser","register"):t.errorRegister="註冊失敗"})):this.errorPassword="密碼不一致請重新輸入"}}},B=J,G=(a("a39d"),Object(v["a"])(B,L,V,!1,null,"3538badf",null)),z=G.exports,K=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"outer"},[a("menu-component"),a("div",{staticClass:"container"},[a("div",{staticClass:"content"},[a("div",{staticClass:"top"},[a("div",{staticClass:"user"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:t.avatarImg,alt:""}})]),a("div",{staticClass:"name"},[t._v(t._s(t.userName||123123123123))])])]),a("div",{staticClass:"btm"},[a("div",{staticClass:"change"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{type:"text",maxlength:"10",placeholder:"更新暱稱"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}}),a("button",{staticClass:"btn",on:{click:t.changeName}},[t._v("更新")])])])])])],1)},Q=[],W={data:function(){return{avatarImg:P.a,name:null}},computed:{userName:function(){return this.$store.state.name}},methods:{changeName:function(){var t=this;this.axios.put("/UpdateUserName",{name:this.name}).then((function(e){e.data.success||t.$router.push({path:"/Login"}),t.$store.commit("updateUserName",t.name),t.name=null}))}}},X=W,Y=(a("e948"),Object(v["a"])(X,K,Q,!1,null,"379b7614",null)),Z=Y.exports,tt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"outer"},[a("menu-component"),a("div",{staticClass:"container"},[a("div",{staticClass:"content"},[a("div",{staticClass:"top"},[a("div",{staticClass:"search"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.account,expression:"account"}],attrs:{type:"text",placeholder:"搜索帳號"},domProps:{value:t.account},on:{input:function(e){e.target.composing||(t.account=e.target.value)}}}),a("button",{staticClass:"btn",on:{click:t.search}},[t._v("搜索")]),a("button",{directives:[{name:"show",rawName:"v-show",value:!t.notFind&&null!==t.user.name,expression:"!notFind && user.name !== null"}],staticClass:"btn",on:{click:t.addFriend}},[t._v(" 加入好友 ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:t.notFind,expression:"notFind"}],staticClass:"notFind"},[t._v("找不到用戶")]),a("span",{directives:[{name:"show",rawName:"v-show",value:t.newFriesn,expression:"newFriesn"}],staticClass:"newFriesn"},[t._v("快跟新朋友聊天吧!")])])]),a("div",{staticClass:"btm",class:{find:t.user.account}},[a("div",{staticClass:"user"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:t.avatarImg,alt:""}})]),a("div",{staticClass:"name"},[t._v(t._s(t.user.name))])])])])])],1)},et=[],at={data:function(){return{avatarImg:P.a,account:null,user:{account:null,name:null},notFind:null,newFriesn:null}},methods:{search:function(){var t=this;this.axios.get("/SearchUser",{params:{account:this.account}}).then((function(e){t.newFriesn=null,t.account=null,e.data.success?(t.user=e.data.user,t.notFind=!1):(t.notFind=!0,t.user={account:null,name:null,state:null})}))},addFriend:function(){var t=this;this.axios.post("/AddFriend",{account:this.user.account}).then((function(e){e.data.success&&(t.$store.commit("setUser","newFriesn"),t.newFriesn=!0)}))}}},nt=at,st=(a("4a71"),Object(v["a"])(nt,tt,et,!1,null,"45042f1e",null)),rt=st.exports;n["a"].use(b["a"]);var it=[{path:"/",component:j,meta:{requiresAuth:!0}},{path:"/login",component:M},{path:"/register",component:z},{path:"/chat/:id",component:I,meta:{requiresAuth:!0}},{path:"/user",component:Z,meta:{requiresAuth:!0}},{path:"/search",component:rt,meta:{requiresAuth:!0}}],ot=new b["a"]({mode:"history",base:"/HaTalk/",routes:it});ot.beforeEach(function(){var t=Object(w["a"])(regeneratorRuntime.mark((function t(e,a,n){var s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s=e.matched.some((function(t){return t.meta.requiresAuth})),a.matched.length){t.next=4;break}return t.next=4,_.dispatch("getUser");case 4:r=_.state.auth,s?r?n():n({path:"/login"}):n();case 6:case"end":return t.stop()}}),t)})));return function(e,a,n){return t.apply(this,arguments)}}());var ct=ot,ut=(a("f5df1"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"outer"},[a("div",{staticClass:"head"},[a("h2",[t._v("HaTalk")]),a("div",{staticClass:"avatar"},[a("img",{attrs:{src:t.avatarImg,alt:""}})]),a("div",{staticClass:"name"},[t._v(t._s(t.name))])]),a("div",{staticClass:"body"},[a("router-link",{staticClass:"btn",attrs:{to:"/User"}}),a("router-link",{staticClass:"btn",attrs:{to:"/Search"}}),a("router-link",{staticClass:"btn",attrs:{to:"/"}}),a("router-link",{staticClass:"btn",attrs:{to:"/login"}})],1),t._m(0)])}),lt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"footer"},[a("span",[t._v("Copyright © 2021 Viaje9 Design.")])])}],dt={data:function(){return{avatarImg:P.a}},computed:{name:function(){return this.$store.state.name}}},mt=dt,pt=(a("440b"),Object(v["a"])(mt,ut,lt,!1,null,"c1adb486",null)),vt=pt.exports;n["a"].component("menu-component",vt),n["a"].use(r.a,d),n["a"].use(new o.a({connection:"https://ha-talk-api.herokuapp.com/"})),n["a"].config.productionTip=!1,new n["a"]({router:ct,store:_,render:function(t){return t(g)}}).$mount("#app")},5889:function(t,e,a){},"5c0b":function(t,e,a){"use strict";a("9c0c")},"9c0c":function(t,e,a){},a39d:function(t,e,a){"use strict";a("f760")},a692:function(t,e,a){t.exports=a.p+"img/avatar.2ca5f0e8.svg"},a88b:function(t,e,a){},b129:function(t,e,a){},c178:function(t,e,a){},c67d:function(t,e,a){"use strict";a("5889")},e948:function(t,e,a){"use strict";a("c178")},f60d:function(t,e,a){},f760:function(t,e,a){}});
//# sourceMappingURL=app.3cf304d4.js.map